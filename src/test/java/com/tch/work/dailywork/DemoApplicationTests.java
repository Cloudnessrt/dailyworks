package com.tch.work.dailywork;
import com.alibaba.fastjson.JSONArray;
import com.alibaba.fastjson.JSONObject;
import org.apache.http.HttpResponse;
import org.apache.http.HttpStatus;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.entity.StringEntity;
import org.apache.http.impl.client.DefaultHttpClient;

import java.io.FileOutputStream;
import java.io.OutputStream;
import java.nio.charset.Charset;
import java.util.*;

import org.apache.http.util.EntityUtils;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

@RunWith(SpringRunner.class)
@SpringBootTest
public class DemoApplicationTests {

    List<Dist> list=new ArrayList();
    @Test
    public void contextLoads() {

        HttpPost post = null;
        try {
            HttpClient httpClient = new DefaultHttpClient();
            String url="http://10.5.74.49:8080/api/global/json/getdistrictdetail?Content-Type=application/json&SOA20-Client-AppId=760101";
            post = new HttpPost(url);
            // 构造消息头
            post.setHeader("Content-type", "application/json; charset=utf-8");
            post.setHeader("SOA20-Client-AppId", "760101");

            // 构建消息实体
            StringEntity entity = new StringEntity(body, Charset.forName("UTF-8"));
            entity.setContentEncoding("UTF-8");
            // 发送Json格式的数据请求
            entity.setContentType("application/json");
            post.setEntity(entity);

            HttpResponse response = httpClient.execute(post);

            // 检验返回码
            int statusCode = response.getStatusLine().getStatusCode();
            if(statusCode != HttpStatus.SC_OK) {
                System.out.printf(" false");
            }else{
                String str = "";
                /**读取服务器返回过来的json字符串数据**/
                str = EntityUtils.toString(response.getEntity());
                DistResult json_test = JSONObject.parseObject(str,DistResult.class);
                list.addAll(json_test.getResult());

                String [] a={"districtId","name"};
                Map<String,String> map=new HashMap();
                for(int i=0;i<a.length;i++){
                    map.put(a[i],a[i]);
                }
                ExportExcel.excelExport(list,map,"poi");
            }
            }
            catch (Exception e){

            }
    }

    static  String body="{\n" +
            "    \"districtIds\":[\n" +
            "       23670,\n" +
            "747,\n" +
            "253,\n" +
            "574,\n" +
            "357,\n" +
            "1389,\n" +
            "14747,\n" +
            "17072,\n" +
            "16545,\n" +
            "11305,\n" +
            "59493,\n" +
            "16477,\n" +
            "614,\n" +
            "355,\n" +
            "34603,\n" +
            "1922,\n" +
            "45556,\n" +
            "1973,\n" +
            "389,\n" +
            "1874,\n" +
            "16238,\n" +
            "1474,\n" +
            "15833,\n" +
            "407,\n" +
            "14748,\n" +
            "1608,\n" +
            "16478,\n" +
            "1932,\n" +
            "36133,\n" +
            "1532876,\n" +
            "718,\n" +
            "2094,\n" +
            "16479,\n" +
            "15844,\n" +
            "117,\n" +
            "1527,\n" +
            "1631,\n" +
            "16412,\n" +
            "380,\n" +
            "24536,\n" +
            "667,\n" +
            "1728,\n" +
            "19312,\n" +
            "120370,\n" +
            "1958,\n" +
            "1998,\n" +
            "1610,\n" +
            "16140,\n" +
            "50850,\n" +
            "721,\n" +
            "1974,\n" +
            "365,\n" +
            "1411,\n" +
            "1502,\n" +
            "1873,\n" +
            "1825,\n" +
            "1956,\n" +
            "1861,\n" +
            "321,\n" +
            "275,\n" +
            "1546,\n" +
            "298,\n" +
            "60498,\n" +
            "60873,\n" +
            "23982,\n" +
            "29335,\n" +
            "1876,\n" +
            "30966,\n" +
            "45534,\n" +
            "1589786,\n" +
            "1990,\n" +
            "154,\n" +
            "120061,\n" +
            "198,\n" +
            "8,\n" +
            "1447232,\n" +
            "436,\n" +
            "1989,\n" +
            "18282,\n" +
            "30891,\n" +
            "33976,\n" +
            "1926,\n" +
            "753,\n" +
            "1867,\n" +
            "716,\n" +
            "1915,\n" +
            "1815,\n" +
            "14767,\n" +
            "1080,\n" +
            "14773,\n" +
            "781,\n" +
            "695,\n" +
            "16512,\n" +
            "1341,\n" +
            "48568,\n" +
            "1589416,\n" +
            "31679,\n" +
            "15798,\n" +
            "18339,\n" +
            "1100,\n" +
            "1824,\n" +
            "730,\n" +
            "17534,\n" +
            "23145,\n" +
            "14868,\n" +
            "931,\n" +
            "9878,\n" +
            "1763,\n" +
            "1262,\n" +
            "1594,\n" +
            "819,\n" +
            "19479,\n" +
            "1467,\n" +
            "24603,\n" +
            "36076,\n" +
            "15321,\n" +
            "822,\n" +
            "42960,\n" +
            "8532,\n" +
            "1205,\n" +
            "1677879,\n" +
            "1489,\n" +
            "1126,\n" +
            "1109,\n" +
            "1683,\n" +
            "1595,\n" +
            "1680,\n" +
            "712,\n" +
            "56306,\n" +
            "4592,\n" +
            "2007,\n" +
            "1573,\n" +
            "1571,\n" +
            "1444952,\n" +
            "19628,\n" +
            "661,\n" +
            "305,\n" +
            "1402,\n" +
            "572,\n" +
            "388,\n" +
            "790,\n" +
            "1449,\n" +
            "1390,\n" +
            "1761,\n" +
            "1549,\n" +
            "1128,\n" +
            "6394,\n" +
            "1519,\n" +
            "1541,\n" +
            "6383,\n" +
            "7353,\n" +
            "340,\n" +
            "6584,\n" +
            "6982,\n" +
            "1041,\n" +
            "6389,\n" +
            "449,\n" +
            "451,\n" +
            "1467041,\n" +
            "22536,\n" +
            "10362,\n" +
            "14894,\n" +
            "151,\n" +
            "456,\n" +
            "1701,\n" +
            "57931,\n" +
            "1594728,\n" +
            "57930,\n" +
            "482,\n" +
            "597,\n" +
            "1026,\n" +
            "326,\n" +
            "410,\n" +
            "1098,\n" +
            "17361,\n" +
            "2039,\n" +
            "777,\n" +
            "411,\n" +
            "19953,\n" +
            "30509,\n" +
            "327,\n" +
            "30450,\n" +
            "30444,\n" +
            "17324,\n" +
            "328,\n" +
            "58047,\n" +
            "17829,\n" +
            "352,\n" +
            "2093,\n" +
            "1854,\n" +
            "46979,\n" +
            "29044,\n" +
            "29020,\n" +
            "1414,\n" +
            "934,\n" +
            "20991,\n" +
            "1866,\n" +
            "20971,\n" +
            "36,\n" +
            "24365,\n" +
            "932,\n" +
            "41874,\n" +
            "1712,\n" +
            "13759,\n" +
            "13758,\n" +
            "1679734,\n" +
            "1552,\n" +
            "1556,\n" +
            "48028,\n" +
            "48054,\n" +
            "720,\n" +
            "1042,\n" +
            "1748,\n" +
            "21788,\n" +
            "1730,\n" +
            "1735,\n" +
            "1738,\n" +
            "1734,\n" +
            "588,\n" +
            "1082,\n" +
            "6783,\n" +
            "5132,\n" +
            "1520,\n" +
            "48042,\n" +
            "1585969,\n" +
            "2098,\n" +
            "1734678,\n" +
            "1626,\n" +
            "31702,\n" +
            "19603,\n" +
            "452,\n" +
            "49685,\n" +
            "301,\n" +
            "18250,\n" +
            "1117,\n" +
            "1477,\n" +
            "1585,\n" +
            "726,\n" +
            "24560,\n" +
            "1459553,\n" +
            "1725,\n" +
            "440,\n" +
            "1283,\n" +
            "792,\n" +
            "32649,\n" +
            "258,\n" +
            "29026,\n" +
            "1324,\n" +
            "1237,\n" +
            "1443,\n" +
            "39095,\n" +
            "50052,\n" +
            "45912,\n" +
            "1131,\n" +
            "548,\n" +
            "1914,\n" +
            "45922,\n" +
            "259,\n" +
            "1553,\n" +
            "14699,\n" +
            "1409,\n" +
            "1175,\n" +
            "29029,\n" +
            "29138,\n" +
            "10,\n" +
            "393,\n" +
            "32,\n" +
            "626,\n" +
            "684,\n" +
            "16990,\n" +
            "1444887,\n" +
            "1444456,\n" +
            "1884,\n" +
            "1048,\n" +
            "1192,\n" +
            "1811,\n" +
            "1863,\n" +
            "57983,\n" +
            "1696,\n" +
            "16904,\n" +
            "1916,\n" +
            "1617,\n" +
            "1393,\n" +
            "437,\n" +
            "24736,\n" +
            "31,\n" +
            "16918,\n" +
            "237,\n" +
            "106,\n" +
            "1711,\n" +
            "30560,\n" +
            "552,\n" +
            "444,\n" +
            "358,\n" +
            "1448018,\n" +
            "13729,\n" +
            "41693,\n" +
            "1539,\n" +
            "1422,\n" +
            "2011,\n" +
            "1858,\n" +
            "20226,\n" +
            "1826,\n" +
            "16826,\n" +
            "20546,\n" +
            "391,\n" +
            "6830,\n" +
            "20587,\n" +
            "302,\n" +
            "16421,\n" +
            "1029,\n" +
            "11456,\n" +
            "19183,\n" +
            "20942,\n" +
            "1657511,\n" +
            "49755,\n" +
            "725,\n" +
            "745,\n" +
            "1494,\n" +
            "17370,\n" +
            "1473,\n" +
            "1190,\n" +
            "791,\n" +
            "130689,\n" +
            "1864,\n" +
            "19240,\n" +
            "2009,\n" +
            "1852,\n" +
            "20975,\n" +
            "22909,\n" +
            "17880,\n" +
            "1685,\n" +
            "14022,\n" +
            "14161,\n" +
            "1039,\n" +
            "14236,\n" +
            "16839,\n" +
            "1629,\n" +
            "17932,\n" +
            "17938,\n" +
            "1627,\n" +
            "1810,\n" +
            "10556,\n" +
            "7063,\n" +
            "13610,\n" +
            "789,\n" +
            "939,\n" +
            "1444132,\n" +
            "584,\n" +
            "579,\n" +
            "610,\n" +
            "1694477,\n" +
            "367,\n" +
            "749,\n" +
            "1362,\n" +
            "1027,\n" +
            "1173,\n" +
            "1752,\n" +
            "15363,\n" +
            "2016,\n" +
            "2012,\n" +
            "15481,\n" +
            "15016,\n" +
            "1975092,\n" +
            "1032,\n" +
            "15346,\n" +
            "14404,\n" +
            "4,\n" +
            "1433,\n" +
            "944,\n" +
            "580,\n" +
            "1044,\n" +
            "1405,\n" +
            "21122,\n" +
            "51841,\n" +
            "21114,\n" +
            "715,\n" +
            "629,\n" +
            "21229,\n" +
            "933,\n" +
            "1702,\n" +
            "18474,\n" +
            "1441,\n" +
            "31119,\n" +
            "21001,\n" +
            "1964,\n" +
            "1733,\n" +
            "713,\n" +
            "1391,\n" +
            "1550,\n" +
            "1448,\n" +
            "1202,\n" +
            "356,\n" +
            "1621,\n" +
            "51866,\n" +
            "57794,\n" +
            "21293,\n" +
            "52834,\n" +
            "1795,\n" +
            "1261,\n" +
            "1418,\n" +
            "36923,\n" +
            "31973,\n" +
            "1116,\n" +
            "31978,\n" +
            "57920,\n" +
            "31966,\n" +
            "1331,\n" +
            "2015,\n" +
            "23684,\n" +
            "28178,\n" +
            "15143,\n" +
            "15413,\n" +
            "761,\n" +
            "795,\n" +
            "31436,\n" +
            "1708,\n" +
            "1727,\n" +
            "1498,\n" +
            "16360,\n" +
            "47272,\n" +
            "1722,\n" +
            "21489,\n" +
            "14797,\n" +
            "727,\n" +
            "36033,\n" +
            "36006,\n" +
            "14793,\n" +
            "21486,\n" +
            "796,\n" +
            "1737512,\n" +
            "57052,\n" +
            "379,\n" +
            "55512,\n" +
            "20812,\n" +
            "21357,\n" +
            "1642,\n" +
            "1529,\n" +
            "4137,\n" +
            "35851,\n" +
            "20834,\n" +
            "4029,\n" +
            "1658,\n" +
            "20835,\n" +
            "29766,\n" +
            "1229,\n" +
            "1693,\n" +
            "940,\n" +
            "29745,\n" +
            "297,\n" +
            "14777,\n" +
            "1857,\n" +
            "24779,\n" +
            "49700,\n" +
            "760,\n" +
            "218,\n" +
            "1694,\n" +
            "128120,\n" +
            "1721,\n" +
            "1286,\n" +
            "2064,\n" +
            "4367,\n" +
            "19895,\n" +
            "1903199,\n" +
            "20774,\n" +
            "20763,\n" +
            "10097,\n" +
            "734,\n" +
            "1649,\n" +
            "32955,\n" +
            "1647,\n" +
            "5467,\n" +
            "1856,\n" +
            "1049,\n" +
            "4483,\n" +
            "1636,\n" +
            "20863,\n" +
            "1267,\n" +
            "13718,\n" +
            "1923,\n" +
            "4479,\n" +
            "15217,\n" +
            "20885,\n" +
            "8396,\n" +
            "5365,\n" +
            "4484,\n" +
            "20836,\n" +
            "549,\n" +
            "23185,\n" +
            "15100,\n" +
            "5359,\n" +
            "1495,\n" +
            "30546,\n" +
            "6947,\n" +
            "1245,\n" +
            "19030,\n" +
            "1619,\n" +
            "2071,\n" +
            "1829,\n" +
            "1579,\n" +
            "15746,\n" +
            "5681,\n" +
            "5624,\n" +
            "32652,\n" +
            "1540,\n" +
            "31716,\n" +
            "1618,\n" +
            "1382,\n" +
            "1910,\n" +
            "136125,\n" +
            "1166,\n" +
            "21413,\n" +
            "2125,\n" +
            "14697,\n" +
            "1720,\n" +
            "1724,\n" +
            "13831,\n" +
            "1713,\n" +
            "1323,\n" +
            "1912,\n" +
            "37561,\n" +
            "1447131,\n" +
            "3040,\n" +
            "56721,\n" +
            "1773,\n" +
            "1279,\n" +
            "1663,\n" +
            "1822,\n" +
            "32617,\n" +
            "29961,\n" +
            "1625,\n" +
            "1046,\n" +
            "28125,\n" +
            "450,\n" +
            "766,\n" +
            "18001,\n" +
            "38275,\n" +
            "1430,\n" +
            "52776,\n" +
            "1809,\n" +
            "20966,\n" +
            "9863,\n" +
            "32650,\n" +
            "1813,\n" +
            "7560,\n" +
            "1819,\n" +
            "32654,\n" +
            "32696,\n" +
            "5427,\n" +
            "15612,\n" +
            "15506,\n" +
            "15105,\n" +
            "1276,\n" +
            "18609,\n" +
            "1592,\n" +
            "13750,\n" +
            "13134,\n" +
            "17332,\n" +
            "1485,\n" +
            "22026,\n" +
            "45967,\n" +
            "36073,\n" +
            "1710,\n" +
            "2091,\n" +
            "57985,\n" +
            "59414,\n" +
            "22014,\n" +
            "1817,\n" +
            "7567,\n" +
            "1740,\n" +
            "1862,\n" +
            "2073,\n" +
            "37696,\n" +
            "128\n" +
            "    ]\n" +
            "}\n";



}
